<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="#"> 
	<title>柱形图</title>
	<style type="text/css">
		svg{
			background: #eee; 
		}

		.axis path,
		.axis line{
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.axis text {
			font-family: sans-serif;
			font-size: 11px;
		}

		.rect {
			fill: steelblue;
		}
		.text {
			fill: white;
			text-anchor: middle;
		}

	</style>
</head>
<body>

<svg class="histogram" width="400" height="400"></svg>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script type="text/javascript">
	// 获取画布信息
	var svg = d3.select('.histogram');
	var width = svg.attr('width');
	var height = svg.attr('height');
	var padding = {left: 40, right: 20, top: 20, bottom: 40};	// svg padding

	// 定义数据和比例尺
	var dataset = [56, 87, 96, 77, 89, 73, 61, 40];
	var xScale = d3.scale.ordinal()
					.domain(d3.range(dataset.length))
					.rangeRoundBands([0, width - padding.left - padding.right]);
	var yScale = d3.scale.linear()
					.domain([0, d3.max(dataset)])
					.range([height - padding.top - padding.bottom, 0]);

	// 定义坐标轴
	var xAxis = d3.svg.axis()
					.scale(xScale)
					.orient('bottom');
	var yAxis = d3.svg.axis()
					.scale(yScale)
					.ticks(10)
					.orient('left');

	// 添加矩形
	var rectPadding = 6;   			// 矩形空白间隔
	var rects = svg.selectAll('.rect')
					.data(dataset)
					.enter()
					.append('rect')
					.attr('class', 'rect')
					.attr('transform', 'translate('+padding.left+', '+padding.top+')')
					.attr('x', function(d, i){
						return xScale(i) + rectPadding/2;
					})
					.attr('y', function(d, i){
						return yScale(d);
					})
					.attr('width', xScale.rangeBand() - rectPadding)
					.attr('height', function(d){
						return height - yScale(d) - padding.top - padding.bottom;
					});

	// 添加文字
	var texts = svg.selectAll('.text')
					.data(dataset)
					.enter()
					.append('text')
					.attr('class', 'text')
					.attr('transform', 'translate('+padding.left+', '+padding.top+')')
					.attr('x', function(d, i){
						return xScale(i) + rectPadding/2;
					})
					.attr('y', function(d){
						return yScale(d);
					})
					.attr('dx', function(){
						return (xScale.rangeBand() - rectPadding)/2;
					})
					.attr('dy', function(d){
						return 20;
					})
					.text(function(d){
						return d;
					});

	// 添加坐标轴
	svg.append('g')
		.attr('class', 'axis')
		.attr('transform', 'translate('+padding.left+', '+(height - padding.bottom)+')')
		.call(xAxis);
	svg.append('g')
		.attr('class', 'axis')
		.attr('transform', 'translate('+padding.left+', '+padding.top+')')
		.call(yAxis);
</script>
</body>
</html>