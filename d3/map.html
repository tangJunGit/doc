<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="renderer" content="webkit"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="#">
    <title>地图</title>
    <style type="text/css">
        svg.map{
            background: #eee; 
        }
        .map path{
            stroke: #000;
            stroke-width: 1;
        }

    </style>
</head>
<body>

<svg class="map" width="600" height="600"></svg>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script type="text/javascript">
    // 获取画布信息
    var svg = d3.select('svg.map');
    var width = svg.attr('width');
    var height = svg.attr('height');


    // 投影函数
    // 由于 GeoJSON 文件中的地图数据，都是经度和纬度的信息。它们都是三维的，
    // 而要在网页上显示的是二维的，所以要设定一个投影函数来转换经度纬度。
    var projection = d3.geo.mercator()
                            .center([107, 31])                // 设定地图的中心位置
                            .scale(500)                       // 设定放大的比例
                            .translate([width/2, height/2]);  // 设定平移

    // 地理路径生成器
    var path = d3.geo.path()
                      .projection(projection);


    // 获取数据
    d3.json("data/china.json", function(error, root) {       
      if (error) return console.error(error);

      // console.log(root.features);
      
      // 绘制图形
      var color20 = d3.scale.category20();

      svg.selectAll("path")
          .data( root.features )
          .enter()
          .append("path")
          .attr("fill", function(d, i){
              return color20(i);
          })
          .attr("d", path )               // 使用地理路径生成器
          .on("mouseover",function(d,i){
              d3.select(this)
                 .attr("fill", "yellow");
          })
          .on("mouseout",function(d,i){
              d3.select(this)
                 .attr("fill", color20(i));
          });
    });

</script>
</body>
</html>