<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="renderer" content="webkit"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="#">
    <title>刷子</title>
    <style type="text/css">
        svg.brush{
            background: #eee;
        }
    </style>
</head>
<body>
   <svg class="brush" width="400" height="400"></svg>

   <script src="https://d3js.org/d3.v4.min.js"></script>
   <script>
        // 获取svg信息
        var svg = d3.select('.brush')
            width = svg.attr('width'),
            height = svg.attr('height'),
            padding = {left: 40, right: 40, top: 30, bottom: 30};

        // 创建50个随机数
        var data = d3.range(0,200).map(function(d){
                        return {
                            x:Math.random()*width,
                            y:Math.random()*height
                        }
                    });
        // console.log(data);


        // 线性比例尺
        var xScale = d3.scaleLinear()
                    .domain([0,width])
                    .range([0,width-padding.left-padding.right]);

        var yScale = d3.scaleLinear()
                    .domain([0,height])
                    .range([height-padding.top-padding.bottom,0]);


        // 绘画坐标轴
        var x_g = svg.append('g');
        x_g.append('g').attr('transform','translate('+padding.left+','+padding.top+')')
            .call(d3.axisTop(xScale));
        x_g.append('g').attr('transform','translate('+padding.left+','+(height-padding.bottom)+')')
            .call(d3.axisBottom(xScale));

        var y_g = svg.append('g');
        y_g.append('g').attr('transform','translate('+padding.left+','+padding.top+')')
            .call(d3.axisLeft(yScale));
        y_g.append('g').attr('transform','translate('+(width-padding.right)+','+padding.top+')')
            .call(d3.axisRight(yScale));
        

        // 绘画点
        var circle_g = svg.append('g')
                    .attr('transform','translate('+padding.left+','+padding.top+')');
        var points = circle_g.selectAll('.points')
                        .data(data)
                        .enter()
                        .append('circle')
                        .attr('class','points')
                        .attr('r', 2)
                        .attr('cx',function(d){
                            return xScale(d.x);
                        })
                        .attr('cy',function(d){
                            return yScale(d.y);
                        })
                        .attr("fill","steelblue");

        // 绘画刷子
        var brush = d3.brush()
                    .extent([[0,0],[width-padding.left-padding.right, height-padding.top-padding.bottom]])      // 范围区间
                    .on('brush',function(){                                                                     // 刷子事件
                        points.attr('fill','steelblue')
                            .filter((d)=>{                            // 过滤不在区间的点
                                return  (xScale(d.x)>=d3.event.selection[0][0] && xScale(d.x)<=d3.event.selection[1][0]) &&
                                        (yScale(d.y)>=d3.event.selection[0][1] && yScale(d.y)<=d3.event.selection[1][1])
                            })
                            .attr('fill','red');
                    });

        circle_g.append('g').call(brush);

   </script>
</body>
</html>